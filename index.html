<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">

<!-- مهم جدًا للآيفون -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>رسالتي لصغيرتي ❤️</title>

<!-- خط Cairo -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
*{
  box-sizing:border-box;
  font-family:'Cairo',sans-serif;
}

body{
  margin:0;
  overflow:hidden;
  background:#000;
}

/* VIEWPORT */
#viewport{
  width:100vw;
  height:100vh;
  overflow:hidden;
  position:relative;
}

/* BACKGROUND */
#bg{
  position:absolute;
  top:0;
  left:0;
  width:5200px;
  height:100%;
  background:url("https://i.imgur.com/L2VGPX4.jpeg") center/cover no-repeat;
}

/* WORLD */
#world{
  position:absolute;
  bottom:0;
  width:4800px;
  height:100%;
}

/* GROUND */
#ground{
  position:absolute;
  bottom:0;
  width:100%;
  height:170px;
  background:linear-gradient(#4caf50,#2e7d32);
}

/* PLAYER */
#player{
  position:absolute;
  bottom:170px;
  left:120px;
  width:72px;
  height:72px;
  background:url("https://i.imgur.com/bsB0WVm.png") center/contain no-repeat;
}

/* DOORS */
.door{
  position:absolute;
  bottom:170px;
  width:130px;
  height:170px;
  background:url("https://i.imgur.com/u6eamGM.png") center/contain no-repeat;
  transition:transform .5s ease,opacity .5s ease;
}

.door.hide{
  transform:scale(.3);
  opacity:0;
  pointer-events:none;
}

/* UI */
#ui{
  position:fixed;
  top:10px;
  right:10px;
  color:#fff;
  font-size:18px;
  z-index:10;
}

/* CONTROLS */
#controls{
  position:fixed;
  bottom:25px;
  left:20px;
  display:flex;
  gap:20px;
  z-index:10;
}

.ctrl{
  width:80px;
  height:80px;
  border-radius:50%;
  font-size:32px;
  border:none;
}

/* QUIZ */
#quiz{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.75);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:30;
}

#quizBox{
  background:#111;
  padding:22px;
  width:90%;
  max-width:420px;
  border-radius:18px;
  color:#fff;
  text-align:center;
}

#quizBox input{
  width:100%;
  padding:12px;
  margin:14px 0;
  border-radius:10px;
  border:none;
}

/* FINAL MESSAGE */
#finalMessage{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
}

#finalBox{
  color:#fff;
  text-align:center;
  padding:25px;
  line-height:1.9;
}
</style>
</head>

<body>

<div id="viewport">
  <div id="bg"></div>
  <div id="world">
    <div id="player"></div>
    <div id="ground"></div>
  </div>
</div>

<div id="ui">
  الأبواب المفتوحة: <span id="opened">0</span>/20
</div>

<div id="controls">
  <button class="ctrl" id="left">◀</button>
  <button class="ctrl" id="right">▶</button>
</div>

<div id="quiz">
  <div id="quizBox">
    <div id="question">سؤال من قلبي ❤️</div>
    <input id="answer" placeholder="اكتبي إجابتك ❤️">
    <button id="submit">فتح الباب</button>
  </div>
</div>

<div id="finalMessage">
  <div id="finalBox">
    ❤️ إلى صغيرتي ❤️<br><br>
    بحبك من كل قلبي<br>
    وانتي أغلى حاجة في حياتي ❤️
  </div>
</div>

<script>
const player=document.getElementById("player");
const world=document.getElementById("world");
const bg=document.getElementById("bg");
const openedEl=document.getElementById("opened");

let x=120,dir=0,speed=4;
let opened=0,quizOpen=false,currentDoor=null;

for(let i=0;i<20;i++){
  const d=document.createElement("div");
  d.className="door";
  d.style.left=(650+i*190)+"px";
  world.appendChild(d);
}

function loop(){
  if(!quizOpen){
    x+=dir*speed;
    x=Math.max(0,Math.min(4600,x));
  }

  player.style.left=x+"px";

  const cam=x-innerWidth/2;
  world.style.transform=`translateX(${-cam}px)`;
  bg.style.transform=`translateX(${-cam*0.2}px)`;

  document.querySelectorAll(".door").forEach(d=>{
    if(d.classList.contains("hide"))return;
    if(Math.abs(d.offsetLeft-x)<80&&!quizOpen){
      openQuiz(d);
    }
  });

  requestAnimationFrame(loop);
}
loop();

const quiz=document.getElementById("quiz");
const q=document.getElementById("question");
const a=document.getElementById("answer");

function openQuiz(d){
  quizOpen=true;
  dir=0;
  currentDoor=d;
  quiz.style.display="flex";
  a.value="";
}

submit.onclick=()=>{
  quiz.style.display="none";
  quizOpen=false;
  currentDoor.classList.add("hide");
  opened++;
  openedEl.textContent=opened;
  if(opened===20){
    finalMessage.style.display="flex";
  }
};

/* TOUCH CONTROLS */
left.ontouchstart=()=>dir=-1;
right.ontouchstart=()=>dir=1;
left.ontouchend=()=>dir=0;
right.ontouchend=()=>dir=0;
</script>

</body>
</html>
